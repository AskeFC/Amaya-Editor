<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <meta name="RCS-Id" content="$Id: NOTE-SYMM-modules-19990223.html,v 1.2     
                                       1999/02/23 19:58:44 renaudb Exp $">
  <meta content="text/xhtml; charset=iso-8859-1" http-equiv="Content-Type">
  <title>Templates installation guide - Server side</title>
</head>

<body>

<div class="head">
<p><a href="/"><img border="0" alt="W3C" src="../../Icons/WWW/w3c_home"></a>
 <a href="../"><img border="0" alt="Amaya"
src="../Icons/amaya.gif"></a></p>

<h1>Installing a template server for Amaya</h1>

<p>A template is a model, or skeleton, of a document, which you may use while
creating a new document. Since version 2.2, Amaya supports the use of
templates stored in a server.</p>

<p>This document describes how to configure and install a template server on
an HTTP server. A related document describes <a href="Templates.html">how to
use templates with Amaya</a>.</p>
<hr>

</div>

<h2><a name="Requirements">Requirements</a></h2>

<p>The following software packages are needed :</p>
<ul>
  <li>Apache version  1.3.x or newer</li>
  <li>Perl  version 5.004 or newer</li>
  <li>gcc</li>
  <li>gmake</li>
</ul>

<h2>Download the template server distribution</h2>

<p>The distribution is available as a compressed tar file (about 355832
bytes)</p>
<ul>
  <li>Download from: (<a
    href="http://www.w3.org/Amaya/Distribution/templates.tgz">http</a>) (<a
    href="ftp://ftp.w3.org/pub/amaya/templates.tgz">ftp</a>)</li>
</ul>

<h2><a name="Introduction">Install the template feature on a server</a></h2>

<p>When you untar the distribution file, a templates directory will be created
with the following subdirectories:</p>
<dl>
  <dt><strong>cgi-bin</strong></dt>
    <dd>Perl scripts and related modules</dd>
  <dt><strong>templates</strong></dt>
    <dd>Template and CSS files</dd>
  <dt><strong>conf</strong></dt>
    <dd>Diverse configuration files</dd>
</dl>

<h3>Installing the cgi scripts and templates</h3>
<ul>
  <li>Install the Perl module XML::Parser in your server's cgi-bin directory
    <p><code>cd your-servers/cgi-bin</code></p>
    <p><code>tar -zxvf templates/cgi-bin/XML-Parser-2.23.tar.gz</code></p>
    <p><code>perl Makefile.PL &amp;&amp; make &amp;&amp; make
    install</code></p>
  </li>
  <li>Copy the following Perl script files from the templates/cgi-bin/
    directory to your server's cgi-bin directory
    <p><code>createform.pl</code></p>
    <p><code>sendtemp.pl</code></p>
    <p><code>xmlparser.pl</code></p>
    <p><code>templateconfig.pm</code></p>
    <p><code>language.pm</code></p>
  </li>
  <li>Modify the file <code>templateconfig.pm</code> to fit your needs:
    <pre># location of templates's files
# relative location of css's files
# file used for login/directory correspondence
# Stylesheet for the form
# XML file
# Intelligent publish
# Location of the file amaya.gif used for the form</pre>
  </li>
  <li>Create the directory that will contain the templates.
    <p><code>mkdir /your/templates-dir/</code></p>
  </li>
  <li>Copy the index xml files (<code>templates.xml.fr,
    templates.xml.en</code>) in the templates directory
    <p><code>cp templates/templates/*.xml*  /your/templates-dir/</code></p>
  </li>
  <li>Copy all CSS and template files in that directory.
    <p><code>cp /templates/*.css /home/httpd/templates/</code></p>
  </li>
  <li>Add the following configuration line to your server's httpd.conf
    <p><code>Alias /templates/ /home/httpd/templates/</code></p>
  </li>
</ul>

<h2><a name="SymmModules">Install the intelligent publication feature</a></h2>

<p>This feature allows the users to publish on your server whithout having to
know their publication directory.</p>

<h3>Install the PUT method</h3>

<p>In order to allow direct publication, Apache server must be configured to
accept the <code>HTTP PUT</code> method.</p>

<p>The following steps describe how to install the <a
href="ftp://ftp.w3.org/pub/amaya/put-1.0.src.tar.gz">put.c</a> script. Any
other PUT script will work as well too.</p>
<ul>
  <li>Compile the program put.c and move the binary file in the server script
    directory :
    <p><code>gcc -o /home/httpd/cgi-bin/put PUT/put.c</code></p>
  </li>
  <li>Add the following line to the Apache configuration file srm.conf
    <p><code>Script PUT /home/httpd/cgi-bin/put</code></p>
  </li>
</ul>

<p>For more information about the put feature, follow this link</p>

<p><a href="http://www.apacheweek.com/features/put">Publishing Pages with PUT
- http://www.apacheweek.com/features/put</a></p>

<h3>PUT Access rights</h3>

<p>The  next step consist in allowing the server to manage PUT access
rights.</p>
<ul>
  <li>Add the following line to your Apache configuration file
    <p><code>Include /etc/httpd/conf/templates.conf</code></p>
  </li>
  <li>Copy the file templates.conf in the Apache configuration directory
    <p><code>cp templates/conf/templates.conf
    /etc/httpd/conf/templates.conf</code></p>
  </li>
  <li>Modify the file to fit your configuration :
    <pre>&lt;FilesMatch "sendtemp.pl">
    AuthName: templates                                                                                       #FF0000">templates
    AuthType Basic
    AuthUserFile /etc/httpd/conf/passwd
    AuthGroupFile /etc/httpd/conf/groups
    Options ExecCGI
    order allow,deny allow from all
    require group public
&lt;/FilesMatch></pre>
  </li>
  <li>Add one or more templates users (refer to <a href="#template1">Add a
    template user</a> )</li>
  <li>Start or restart your Apache server</li>
</ul>

<h3><a name="template1">Add a template user</a> ( for intelligent publication
only)</h3>

<p>To add a user allowed to use direct publication on the server, follow the
steps below :</p>
<ul>
  <li>Define a user password. This operation can be carried out with the
    following command <code>htpasswd password_file user_name</code>e.g. :
    <code>htpasswd passwd dupont</code>
    <p>By default, the password file is  <code>/etc/http/conf/passwd</code>.
    If the password file does not exist yet, add the prefix <code>-c</code> to
    the previous command:</p>
    <p>e.g. : <code>htpasswd -c passwd dupont</code></p>
  </li>
  <li>Create the file <code>htuserdir</code> in the apache configuration
    directory.
    <p>This file realize the correspondence between the user login and his
    server publication directory. So add the line like below<br>
    <code>>dupont:/Jean_Dupont/</code><br>
    </p>
    <p><code>dupont</code> is the login and <code>Jean_Dupont</code> is the
    relative address of the publication directory. The absolute address is
    <code>/home/httpd/html/Jean_Dupont</code>.</p>
  </li>
  <li>Create the user publication directory.
    <p><code>mkdir /home/httpd/html/Jean_Dupont</code></p>
  </li>
  <li>Modify the groups configuration file (/etc/httpd/conf/groups) and inert
    the new user.</li>
  <li>Add the following lines to the file templates.conf previously created.
    <pre>&lt;Directory /home/httpd/html/Jean_Dupont>
    AuthName templates
    AuthType Basic
    AuthUserFile /etc/httpd/conf/passwd
    AuthGroupFile /etc/httpd/conf/groups
    Options Includes FollowSymLinks
    AllowOverride None
    order allow,deny allow from all
    &lt;Limit PUT>
      require user dupont
    &lt;/Limit>
&lt;/Directory>
    </pre>
    <p>The authentification name AuthName must be the same as the one in the
    &lt;FilesMatch sendtemp.pl> section previously typed.</p>
  </li>
</ul>

<h2><a name="templates">Add new templates and stylesheets</a></h2>

<p>To add templates and CSS, copy the associated files in your
<code>templates</code> directory and modify the file templates.xml as below
:</p>
<ul>
  <li>For each added template, add the following lines at the end of the file
    templates.xml.
    <pre>&lt;template file="filename.html">
  &lt;name>
     template_name
  &lt;/name>
  &lt;description>
     A description sentence of the template
  &lt;/description>
&lt;/template>
    </pre>
  </li>
  <li>For each added stylesheet, add the following lines at the end of the
    file templates.xml.
    <pre>&lt;stylesheet file="filename.css">
    &lt;name>
       Stylesheet_name
    &lt;/name>
    &lt;description>
       A description sentence of the stylesheet
    &lt;/description>
&lt;/stylesheet></pre>
  </li>
</ul>

<p>The form proposing templates and stylesheets will automatically be updated
and displayed the next time you use the template fonctionality.</p>

<h2>Authors and Contributors</h2>
<ul>
  <li>Luc Bonameau (INRIA), St&eacute;phane Bonhomme (INRIA), <a
    href="mailto:jose.kahan@w3.org">Jos&eacute; Kahan</a> (W3C)</li>
</ul>

<p></p>
<hr>

<address>
  <a href="mailto:kahan@w3.org">Jos&eacute; Kahan</a><br>

</address>

<p><small>Last modified $Date$</small></p>

<p class="policyfooter"><small><a
href="http://www.w3.org/Consortium/Legal/ipr-notice.html#Copyright">Copyright</a>
&nbsp;&copy;&nbsp; 1999 <a href="http://www.w3.org/">W3C</a> (<a
href="http://www.lcs.mit.edu/">MIT</a>, <a
href="http://www.inria.fr/">INRIA</a>, <a href="http://www.keio.ac.jp/">
Keio</a> ), All Rights Reserved. W3C <a
href="http://www.w3.org/Consortium/Legal/ipr-notice.html#Legal_Disclaimer">liability,</a>
<a href="http://www.w3.org/Consortium/Legal/ipr-notice.html#W3C_Trademarks">
trademark</a>, <a
href="http://www.w3.org/Consortium/Legal/copyright-documents.html">document
use</a> and <a
href="http://www.w3.org/Consortium/Legal/copyright-software.html">software
licensing</a> rules apply. Your interactions with this site are in accordance
with our <a
href="http://www.w3.org/Consortium/Legal/privacy-statement.html#Public">public</a>
and <a
href="http://www.w3.org/Consortium/Legal/privacy-statement.html#Members">Member</a>
privacy statements. </small><br>
</p>

<p class="policyfooter"><small>The Perl module <code>XML::Parser </code>is
covered by the same copyright as that of Perl. A copy of this copyright is
included in the templates distribution tar file</small></p>
 
<p></p>
</body>
</html>
