	{ Presentation Schema de structure for MathML.

	  I. Vatton			June 1997	}


PRESENTATION MathML;
VIEWS
   Formatted_view, Math_Structure_view;

#define STRUCT_INDENT 1.5
#define TAG_FONTSIZE 10 pt
#define DOC_FONTSIZE 12 pt
#define TAG_Style Bold
#define TAG_Visibility 7

#ifdef BLACK_WHITE
#define TAG_Color Black
#define ATTR_Color Black
#define ATTRVALUE_Color Black
#define INVALID_Color Black
#define UNKNOWNTAG_Color Black
#else
#define TAG_Color Blue
#define ATTR_Color Blue
#define ATTRVALUE_Color Black
#define INVALID_Color Red
#define UNKNOWNTAG_Color Red
#define LINK_Color DarkIndigo1
#define TARGET_Color DarkGreen2
#endif

#define TAG_Font Helvetica
#define ATTR_Style Bold
#define ATTR_Style_Links_view Italics
#define ATTR_Visibility 6
#define INPUT_Font Courier
#define COMMENT_Visibility 5
#define COMMENT_Font Helvetica
#define COMMENT_Style Italics
#define INVALID_Style Bold
#define INVALID_Visibility 5
#define INVALID_Font Helvetica
#define TableSimpleHSpace 4 pt
#define TableDoubleHSpace 8 pt
#define TableSimpleVSpace 0.4
#define VSpaceBeforeH1 1
#define VSpaceBeforeH2 0.5
#define VSpaceBeforeH3 0.5
#define VSpaceBeforeH4 0.5
#define VSpaceBeforeH5 0.5
#define VSpaceBeforeH6 0.5
#define VSpaceInToC 0.2

DEFAULT

   BEGIN
   Visibility: Enclosing =;
   VertRef: * . Left ;
   HorizRef: Enclosed . HRef;
   Height: Enclosed . Height;
   Width: Enclosed . Width;
   VertPos: HRef = Previous . HRef;
   HorizPos: Left = Previous . Right;
   LineBreak: No;
   Font: Enclosing =;
   Style: Enclosing =;
   Size: Enclosing =;
   Indent: 0;
   Justify: No;
   Adjust: Left;
   LineSpacing: 1;
   Depth : 0;
   UnderLine: Enclosing =;
   Thickness: Enclosing =;
   LineStyle: Enclosing =;
   LineWeight: Enclosing =;
   Background: Enclosing =;
   Foreground: Enclosing =;
   FillPattern: Enclosing =;
   IN Math_Structure_view BEGIN
	VertPos: Top = Previous . Bottom;
	HorizPos: Left = Enclosing . Left;
	END;
   END;

BOXES

 MROW_S: BEGIN
	Content: Text 'MROW';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MROOT_S: BEGIN
	Content: Text 'MROOT';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MSQRT_S: BEGIN
	Content: Text 'MSQRT';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MFRAC_S: BEGIN
	Content: Text 'MFRAC';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MSUBSUP_S: BEGIN
	Content: Text 'MSUBSUP';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MSUB_S: BEGIN
	Content: Text 'MSUB';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MSUP_S: BEGIN
	Content: Text 'MSUP';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MUNDER_S: BEGIN
	Content: Text 'MUNDER';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MOVER_S: BEGIN
	Content: Text 'MOVER';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MUNDEROVER_S: BEGIN
	Content: Text 'MUNDEROVER';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MF_S: BEGIN
	Content: Text 'MF';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		VertPos: Top = Enclosing . Top;
		Width: 1.5;
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MI_S: BEGIN
	Content: Text 'MI';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		VertPos: Top = Enclosing . Top;
		Width: 1.5;
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MO_S: BEGIN
	Content: Text 'MO';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		VertPos: Top = Enclosing . Top;
		Width: 1.5;
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MN_S: BEGIN
	Content: Text 'MN';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		VertPos: Top = Enclosing . Top;
		Width: 1.5;
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MS_S: BEGIN
	Content: Text 'MS';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		VertPos: Top = Enclosing . Top;
		Width: 1.5;
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 MTEXT_S: BEGIN
	Content: Text 'MTEXT';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		VertPos: Top = Enclosing . Top;
		Size: TAG_FONTSIZE;
		Font: TAG_Font;
		Style: TAG_Style;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 VerticalLine: BEGIN
	Content: Graphics 'W';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		VertPos: Top = Creator . Top;
		HorizPos: Left = Enclosing . Left;
		Height: Creator . Height;
		Width: 1.1;
		LineWeight: 2 pt;
		Visibility: TAG_Visibility;  Foreground: TAG_Color;
		END;
	END;

 Bar:	{ fraction bar }
	BEGIN
	LineWeight: 1 pt;
	Height: 0.2;
        Width: Enclosing . Width ;
	HorizPos: Left = Enclosing . Left;
	Content: Graphics 'h';	{ horizontal bar }
	LineStyle: Solid;
	Background: Creator =;
	Foreground: Creator =;
	IN Math_Structure_view
		Visibility: 0;
	END;

 RadicalSymbol:
	BEGIN
	Height: Enclosing . Height;
	Width: Enclosing . Width;
	VertPos: Top = Enclosing . Top;
	HorizPos: Left = Enclosing . Left;
	Content: Symbol 'r';		{ root symbol }
	Depth: Enclosing + 1;
	Background: Creator =;
	Foreground: Creator =;
	IN Math_Structure_view
		Visibility: 0;
	END;

 MOspace: BEGIN
	Content: text ' ';
	Width : 0.3;
	VertPos: HRef = Previous . HRef;
	HorizPos: Left = Previous . Right;
	IN Math_Structure_view
		Visibility: 0;
	END;

 HR_Graph: BEGIN
	Content: Graphics 'h';
	Visibility: 0;
	IN Math_Structure_view BEGIN
		Visibility: 10;
		Height: 0.6;
	        Width: Enclosing . Width ;
		HorizPos: Left = Enclosing . Left;
		VertPos: Top = Previous . Bottom;
		LineWeight: 2 pt;
		Foreground: TAG_Color;
		END;
	END;

RULES

   MathML:
	BEGIN
	CreateLast(HR_Graph);
	PageBreak: No;
	LineBreak: No;
	LineWeight: 1 pt;
	VertPos: Top = Previous . Bottom;
	HorizPos: Left = Enclosing . Left;
	Visibility: Enclosing - 2;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Visibility: 10;
		END;
	END;

   MROW:
	BEGIN
	CreateBefore(MROW_S);
	CreateWith(VerticalLine);
        HorizRef: Enclosed not MF . HRef;
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		Font: Helvetica;
		END;
  	END;

   Component:
	BEGIN
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
  	END;

   Construction:
	BEGIN
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
  	END;

   MROOT:
        BEGIN
	CreateFirst(RadicalSymbol);
	CreateBefore(MROOT_S);
	CreateWith(VerticalLine);
	HorizRef: Enclosed RootBase . HRef ;
	VertPos: HRef = Previous not MF . HRef;
	Gather: Yes;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		Font: Helvetica;
		END;
  	END;

   MSQRT:
        BEGIN
	CreateFirst(RadicalSymbol);
	CreateBefore(MSQRT_S);
	CreateWith(VerticalLine);
	HorizRef: Enclosed RootBase . HRef ;
	VertPos: HRef = Previous not MF . HRef;
	Gather: Yes;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		Font: Helvetica;
		END;
  	END;

   Index:
   	BEGIN
	HorizRef: * . Top;
   	HorizPos: Left = Enclosing.Left;
   	VertPos: Top = Enclosing.Top;
   	Size: Enclosing -2 min 1;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
   	END;
	
   RootBase:	
        BEGIN
	HorizPos: Left = Enclosing . Left + 0.7;
	VertPos: Top = Enclosing . Top + 0.1;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
  	END;

   MFRAC:
	BEGIN
	CreateFirst(Bar);
	CreateBefore(MFRAC_S);
	CreateWith(VerticalLine);
	Width: 0.7 min;
	HorizRef: Enclosed Bar . Bottom + 0.1;
	VertPos: HRef = Previous not MF . HRef;
	Gather: Yes;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
	END;

   Numerator:
	BEGIN
	HorizRef: * . Top;
	VertPos: Bottom = Bar . Top;
	HorizPos: VMiddle = Bar . VMiddle;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   Denominator:
        BEGIN
	HorizRef: * . Top;
	HorizPos: VMiddle = Bar . VMiddle;
	VertPos: Top = Bar . Bottom + 0.1;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   MSUBSUP:
        BEGIN
	Gather: Yes;
	HorizRef: Enclosed  Base. HRef;
	CreateBefore(MSUBSUP_S);
	CreateWith(VerticalLine);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
	END;

   MSUB:
        BEGIN
	Gather: Yes;
	HorizRef: Enclosed  Base. HRef;
	CreateBefore(MSUB_S);
	CreateWith(VerticalLine);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
	END;

   MSUP:
        BEGIN
	Gather: Yes;
	HorizRef: Enclosed  Base. HRef;
	CreateBefore(MSUP_S);
	CreateWith(VerticalLine);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
	END;

   Base:
	BEGIN
	VertPos: NIL;
	HorizPos: Left = Enclosing . Left;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   Superscript:
	BEGIN
	Size: Enclosing -2 min 1;
	HorizRef: * . Top;
	HorizPos: Left = Base . Right;
	VertPos: Bottom = Base . Top + 0.5;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   Subscript:
	BEGIN
	Size: Enclosing -2 min 1;
	HorizRef: * . Top;
	HorizPos: Left = Base . Right;
	VertPos: Top = Base . Bottom - 0.5;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   MUNDER:
        BEGIN
	Gather: Yes;
	HorizRef: Enclosed UnderOverBase . HRef;
	CreateBefore(MUNDER_S);
	CreateWith(VerticalLine);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
	END;

   MOVER:
        BEGIN
	Gather: Yes;
	HorizRef: Enclosed UnderOverBase . HRef;
	CreateBefore(MOVER_S);
	CreateWith(VerticalLine);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
	END;

   MUNDEROVER:
        BEGIN
	Gather: Yes;
	HorizRef: Enclosed UnderOverBase . HRef;
	CreateBefore(MUNDEROVER_S);
	CreateWith(VerticalLine);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		HorizPos: Left = Enclosing . Left + STRUCT_INDENT;
		END;
	END;

   UnderOverBase:
	BEGIN
	VertPos: NIL;
	HorizPos: VMiddle = Enclosing . VMiddle;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   Underscript:
	BEGIN
	Size: Enclosing -2 min 1;
	HorizRef: * . Top;
	HorizPos: VMiddle = Enclosing . VMiddle;
	VertPos: Top = UnderOverBase . Bottom;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   Overscript:
	BEGIN
	Size: Enclosing -2 min 1;
	HorizRef: * . Top;
	HorizPos: VMiddle = Enclosing . VMiddle;
	VertPos: Bottom = UnderOverBase . Top;
	IN Math_Structure_view BEGIN
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   Block:
	BEGIN
	CreateBefore(MROW_S);
	CreateWith(VerticalLine);
	Gather: Yes;
        HorizRef: Enclosed not MF . HRef;
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		END;
	END;

   Block_exp:
	BEGIN
	HorizPos: Left = Previous . Right + 0.1;
	VertPos: Top =  Enclosing . Top;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width - STRUCT_INDENT;
		Height: Enclosed . Height;
		END;
	END;

   MF:
	BEGIN
	CreateFirst(MF_S);
	Height: Enclosing . Height;
	HorizPos: Left = Previous . Right;
	VertPos: Top =  Enclosing . Top;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   MI:
	BEGIN
	CreateFirst(MI_S);
	VertPos: HRef = Previous not MF . HRef;
	Style: Italics;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		Style: Enclosing =;
		END;
	END;

   MO:
	BEGIN
	CreateFirst(MO_S);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   MN:
	BEGIN
	CreateFirst(MN_S);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   MS:
	BEGIN
	CreateFirst(MS_S);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   MTEXT:
	BEGIN
	CreateFirst(MTEXT_S);
	VertPos: HRef = Previous not MF . HRef;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Width: Enclosing . Width;
		Height: Enclosed . Height;
		END;
	END;

   SYMBOL_UNIT:
	BEGIN
	Height: Enclosing . Height;
	Width: Enclosing . Width;
	VertPos: Nil;
	HorizPos: Nil;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Height: Enclosed . Height;
		HorizPos: Left = Previous . Right + 0.5;
		VertPos: HRef = Previous . HRef;
		END;
	END;

   TEXT_UNIT:
	BEGIN
	VertRef: Enclosed . VRef;
	LineBreak: Yes;
	IF immediately within MF
	   VertPos: HMiddle = Enclosing . HMiddle;
	IN Math_Structure_view BEGIN
		Size: DOC_FONTSIZE;
		Height: Enclosed . Height;
		HorizPos: Left = Previous . Right + 0.5;
		VertPos: HRef = Previous . HRef;
		END;
	END;

ATTRIBUTES

  fontslant = plain:
	Style: roman;
  fontslant = italic:
	Style: Italics;

  addspace = nospace:
	BEGIN
	HorizPos: Left = Previous . Right;
	IN Math_Structure_view
		HorizPos: Left = Enclosing . Left;
	END;
  addspace = spacebefore:
	BEGIN
	HorizPos: Left = Previous . Right + 0.3;
	IN Math_Structure_view
		HorizPos: Left = Enclosing . Left;
	END;
  addspace = spaceafter:
	BEGIN
	HorizPos: Left = Previous . Right;
{***	Width: Enclosed . Width + 0.3;
****}	CreateAfter(MOspace);
	IN Math_Structure_view
		HorizPos: Left = Enclosing . Left;
	END;
  addspace = both:
	BEGIN
	HorizPos: Left = Previous . Right + 0.3;
{***	Width: Enclosed . Width + 0.3;
****}	CreateAfter(MOspace);	
	IN Math_Structure_view
		HorizPos: Left = Enclosing . Left;
	END;
END
